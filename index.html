<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live TV â€“ Auto M3U Loader</title>
<style>
body { font-family: Arial; margin:0; background:#111; color:white; }
.header { padding:15px; background:#222; font-size:20px; font-weight:bold; }
.card { background:#1e1e1e; padding:15px; border-radius:10px; margin:10px; }
.card img { width:100%; border-radius:10px; }
.btn { background:#ff4747; padding:10px 15px; border-radius:6px; display:inline-block; color:white; text-decoration:none; }
#popup {
    position:fixed; top:0; left:0; right:0; bottom:0;
    background:rgba(0,0,0,0.7); display:flex;
    align-items:center; justify-content:center;
}
.popup-box {
    background:#fff; color:#000; padding:20px;
    border-radius:10px; width:80%; text-align:center;
}
</style>
</head>
<body>

<!-- POPUP -->
<div id="popup">
    <div class="popup-box">
        <h2>Welcome!</h2>
        <p>Click continue to load Live Channels.</p>
        <button onclick="closePopup()">Continue</button>
    </div>
</div>

<div class="header">Live TV Channels</div>
<div id="content"></div>

<script>
// Close popup
function closePopup() {
    document.getElementById("popup").style.display = "none";
    loadM3U();
}

// M3U URL
const M3U_URL = "https://raw.githubusercontent.com/Jitendra-unatti/fancode/refs/heads/main/data/fancode.m3u";

// Fetch & Parse M3U
async function loadM3U() {
    try {
        const res = await fetch(M3U_URL);
        const text = await res.text();

        const lines = text.split("\n");
        const content = document.getElementById("content");

        let name = "";
        let logo = "";

        lines.forEach(line => {
            line = line.trim();

            if (line.startsWith("#EXTINF")) {
                // Extract name
                const nameMatch = line.match(/,(.*)$/);
                name = nameMatch ? nameMatch[1] : "Unknown Channel";

                // Extract logo
                const logoMatch = line.match(/tvg-logo="(.*?)"/);
                logo = logoMatch ? logoMatch[1] : "https://via.placeholder.com/500x300?text=No+Image";
            }

            if (line.startsWith("http")) {
                const streamURL = line;

                content.innerHTML += `
                <div class="card">
                    <img src="${logo}">
                    <h3>${name}</h3>
                    <a class="btn" href="player.html?url=${encodeURIComponent(streamURL)}">Watch Now</a>
                </div>
                `;
            }
        });

    } catch (e) {
        console.error("Error loading M3U:", e);
        document.getElementById("content").innerHTML = "<p>Error loading channel list.</p>";
    }
}
</script>

</body>
</html>
